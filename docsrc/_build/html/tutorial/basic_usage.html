
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic usage of the cnn module &#8212; cnnclustering  documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="scikit-learn Toy data sets" href="scikit_learn_datasets.html" />
    <link rel="prev" title="Tutorials" href="../_source/tutorials.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="section" id="Basic-usage-of-the-cnn-module">
<h1>Basic usage of the cnn module<a class="headerlink" href="#Basic-usage-of-the-cnn-module" title="Permalink to this headline">¶</a></h1>
<h1><p>Contents</p>
</h1><div class="toc"><ul class="toc-item"><li><p>1  Pre-requirements</p>
<ul class="toc-item"><li><p>1.1  Import dependencies</p>
</li><li><p>1.2  Notebook configuration</p>
</li><li><p>1.3  Package configuration</p>
</li></ul></li><li><p>2  Getting started</p>
<ul class="toc-item"><li><p>2.1  Class API</p>
</li><li><p>2.2  Functional API</p>
</li></ul></li></ul></div><div class="section" id="Pre-requirements">
<h2>Pre-requirements<a class="headerlink" href="#Pre-requirements" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Import-dependencies">
<h3>Import dependencies<a class="headerlink" href="#Import-dependencies" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>import sys

import matplotlib as mpl
import matplotlib.pyplot as plt
import pandas as pd  # Optional dependency

import cnnclustering.cnn as cnn  # CNN clustering
</pre></div>
</div>
</div>
<p>This notebook was created using Python 3.8.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Version information
print(sys.version)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3.8.3 (default, May 15 2020, 15:24:35)
[GCC 8.3.0]
</pre></div></div>
</div>
</div>
<div class="section" id="Notebook-configuration">
<h3>Notebook configuration<a class="headerlink" href="#Notebook-configuration" title="Permalink to this headline">¶</a></h3>
<p>We use <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> to create plots. A <code class="docutils literal notranslate"><span class="pre">&quot;matplotlibrc&quot;</span></code> file (as provided as <code class="docutils literal notranslate"><span class="pre">&quot;${CNNCLUSTERING_DIR}/docs/tutorial/matplotlibrc&quot;</span></code>) can be used to customise the appearance of the plots.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Matplotlib configuration
mpl.rc_file(
    &quot;matplotlibrc&quot;,
    use_default_template=False
)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Axis property defaults for the plots
ax_props = {
    &quot;aspect&quot;: &quot;equal&quot;
}

dot_props = {
    &quot;marker&quot;: &quot;o&quot;,
    &quot;markeredgecolor&quot;: &quot;k&quot;
}
</pre></div>
</div>
</div>
<p>Optionally, we can interface with Pandas.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Pandas DataFrame print options
pd.set_option(&#39;display.max_rows&#39;, 1000)
</pre></div>
</div>
</div>
</div>
<div class="section" id="Package-configuration">
<h3>Package configuration<a class="headerlink" href="#Package-configuration" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cnnclustering</span></code> Python package offers basic options to be configured by the user. On import, a configuration file (<code class="docutils literal notranslate"><span class="pre">&quot;.cnnclusteringrc&quot;</span></code>), located either in the current working directory or the users home, is loaded. If no such file is provided, the package uses a set of reasonable defaults. An example configuration file can be found under <code class="docutils literal notranslate"><span class="pre">${CNNCLUSTERING_DIR}/</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Configuration file found?
cnn.settings.cfgfile  # If None, no file is provided
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Display default settings
cnn.settings.defaults
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;default_cnn_cutoff&#39;: &#39;1&#39;,
 &#39;default_cnn_offset&#39;: &#39;0&#39;,
 &#39;default_radius_cutoff&#39;: &#39;1&#39;,
 &#39;default_member_cutoff&#39;: &#39;2&#39;,
 &#39;default_fit_policy&#39;: &#39;conservative&#39;,
 &#39;float_precision&#39;: &#39;sp&#39;,
 &#39;int_precision&#39;: &#39;sp&#39;}
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Getting-started">
<h2>Getting started<a class="headerlink" href="#Getting-started" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Class-API">
<h3>Class API<a class="headerlink" href="#Class-API" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cnnclustering.cnn</span></code> module provides a user API through the <code class="docutils literal notranslate"><span class="pre">CNN</span></code> clustering class. An instance of this class can be used to bundle input data (e.g. data points) with cluster results (labels, summary) alongside the clustering methods and convenience functions for further analysis (not only in an Molecular Dynamics context). As a guiding principle, a <code class="docutils literal notranslate"><span class="pre">CNN</span></code> cluster object is always associated with one particular data set and allows varying cluster parameters.</p>
<div class="admonition note">
<p><strong>Info:</strong> See also this <strong>scikit-learn</strong> <a class="reference external" href="https://github.com/janjoswig/scikit-learn">fork</a> for an alternative API following a parameter centered approach as <code class="docutils literal notranslate"><span class="pre">sklearn.cluster.cnn</span></code>.</p>
</div>
<p>A clustering using the class API from the <code class="docutils literal notranslate"><span class="pre">cnnclustering.cnn</span></code> module starts with the initialisation of a clustering object:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cnnobj = cnn.CNN()  # Create an empty cluster object
print(cnnobj)       # Print a cluster object overview
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
================================================================================
CNN cluster object
--------------------------------------------------------------------------------
Alias :                         root
Hierachy level :                0

Data point shape :              Parts      - None
                                Points     - None
                                Dimensions - None

Distance matrix calculated :    None
Neighbourhoods calculated :     None
Density graph calculated :      None

Clustered :                     False
Children :                      False
================================================================================

</pre></div></div>
</div>
<p>At any time it can be useful to get an overview over the current state of a clustering, i.e. which data is associated with a cluster object. From top to bottom the information printed above reads:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Alias</span></code>: An optional string description of the object. This can be useful if many objects are handled at the same time.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Hierarchy</span> <span class="pre">level</span></code>: We created this object from scratch, so it will be on the highest possible hierarchy level (0). Dealing with cluster object hierarchies will be described in another tutorial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">point</span> <span class="pre">shape</span></code>: Data can be associated to the object in the form of data points (<span class="math notranslate nohighlight">\(n\)</span> points in <span class="math notranslate nohighlight">\(d\)</span> arbitrary dimensions). Data points constitute a primary input format.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Parts</span></code>: Data point can be organised in independent parts. We will see when this is useful in another tutorial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Points</span></code>: Number of points in the data set.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Dimensions</span></code>: Number of dimension of the data set.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">Distance</span> <span class="pre">matrix</span> <span class="pre">calculated</span></code>: Data can also (additionally or exclusively) be associated to the object in form of pairwise distances (<span class="math notranslate nohighlight">\(n^2\)</span> distances for <span class="math notranslate nohighlight">\(n\)</span> data points). Pairwise distances constitute a primary input format. The number of parts underlying the data set is displayed under <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">point</span> <span class="pre">shape</span></code> even if no points have been loaded explicitly into the object.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Neighbourhoods</span> <span class="pre">calculated</span></code>: The CNN clustering relies on point neighbourhood information that has to be calculated with respect to a search radius <span class="math notranslate nohighlight">\(r\)</span>. Neighbourhoods constitute a secondary input format as they need to be recomputed (from points or distances) for varying values of <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Density</span> <span class="pre">graph</span> <span class="pre">calculated</span></code>: Similar to neighbourhoods data can be associated to the object in form of a density connectivity graph with respect to neighbour search radius <span class="math notranslate nohighlight">\(r\)</span> and a similarity cutoff <span class="math notranslate nohighlight">\(c\)</span>. Density graphs constitute a secondary input format as they need to be recomputed (from points, distances or neighbourhoods) for varying values of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(c\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Clustered</span></code>: Indicates if the data has been cluster, i.e. if label assignments are present.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Children</span></code>: Indicates if cluster objects lower in the cluster hierarchy are linked to the object. Dealing with cluster object hierarchies will be described in another tutorial.</p></li>
</ul>
<p>Data can be passed to the clustering object on initialisation as such (see the tutorial on <strong>Data input formats</strong> an overview on how to pass data of differing nature):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># 2D data points (list of lists, 12 points in 2 dimensions)
data_points = [   # point index
    [0, 0],       # 0
    [1, 1],       # 1
    [1, 0],       # 2
    [0, -1],      # 3
    [0.5, -0.5],  # 4
    [2,  1.5],    # 5
    [2.5, -0.5],  # 6
    [4, 2],       # 7
    [4.5, 2.5],   # 8
    [5, -1],      # 9
    [5.5, -0.5],  # 10
    [5.5, -1.5],  # 11
    ]

cnnobj = cnn.CNN(points=data_points)
print(cnnobj)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
================================================================================
CNN cluster object
--------------------------------------------------------------------------------
Alias :                         root
Hierachy level :                0

Data point shape :              Parts      - 1
                                Points     - 12
                                Dimensions - 2

Distance matrix calculated :    None
Neighbourhoods calculated :     None
Density graph calculated :      None

Clustered :                     False
Children :                      False
================================================================================

</pre></div></div>
</div>
<p>We see in the overview that we have now a data set of 12 points in 2 dimensions loaded into the cluster object. The data points are stored on the clustering object under <code class="docutils literal notranslate"><span class="pre">cnnobj.data</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cnnobj.data.points
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Points([[ 0. ,  0. ],
        [ 1. ,  1. ],
        [ 1. ,  0. ],
        [ 0. , -1. ],
        [ 0.5, -0.5],
        [ 2. ,  1.5],
        [ 2.5, -0.5],
        [ 4. ,  2. ],
        [ 4.5,  2.5],
        [ 5. , -1. ],
        [ 5.5, -0.5],
        [ 5.5, -1.5]])
</pre></div></div>
</div>
<p>To cluster these points we can use the <code class="docutils literal notranslate"><span class="pre">cnnobj.fit</span></code> method. The clustering depends on two parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">radius_cutoff</span></code>: Points are considered neighbours if the distance between them is smaller than this cutoff radius <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cnn_cutoff</span></code>: Points are assigned to the same cluster if they share at least this number of <span class="math notranslate nohighlight">\(c\)</span> common neighbours.</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">cnnobj.fit</span></code> method will figure out which kind of input data is provided. For the clustering procedure, we ultimately need to compute the neighbouring points with respect to the <code class="docutils literal notranslate"><span class="pre">radius_cutoff</span></code> for each point in the data set. Based on the <code class="docutils literal notranslate"><span class="pre">policy</span></code> keyword argument, these neighbours are either pre-computed in bulk (<code class="docutils literal notranslate"><span class="pre">policy</span> <span class="pre">=</span> <span class="pre">&quot;progressive&quot;</span></code>) before the actual clustering or on-the-fly during the clustering (<code class="docutils literal notranslate"><span class="pre">policy</span> <span class="pre">=</span> <span class="pre">&quot;conservative&quot;</span></code>). The current default value for the policy is set to
<code class="docutils literal notranslate"><span class="pre">&quot;conservative&quot;</span></code>. This can be changed in a configuration file with the option <code class="docutils literal notranslate"><span class="pre">&quot;default_fit_policy&quot;</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Compute neighbourhoods on-the-fly
cnnobj.fit(radius_cutoff=1.5, cnn_cutoff=1, policy=&quot;conservative&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Execution time for call of fit: 0 hours, 0 minutes, 0.0009 seconds
--------------------------------------------------------------------------------
#points   R         C         min       max       #clusters %largest  %noise
12        1.500     1         2         None      2         0.417     0.333
--------------------------------------------------------------------------------
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span># Pre-compute neighbourhoods in bulk
cnnobj.fit(radius_cutoff=1.5, cnn_cutoff=1, policy=&quot;progressive&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Execution time for call of fit: 0 hours, 0 minutes, 0.0015 seconds
--------------------------------------------------------------------------------
#points   R         C         min       max       #clusters %largest  %noise
12        1.500     1         2         None      2         0.417     0.333
--------------------------------------------------------------------------------
</pre></div></div>
</div>
<div class="admonition note">
<p><strong>Info:</strong> For this simple small data set there is virtually no performance difference between the policies. In general, bulk computation can be computationally more efficient as we can easily make use of efficient external neighbour-search methods. It also allows us to recycle once computed neighbourhood information for cluster approaches with varying <code class="docutils literal notranslate"><span class="pre">cnn_cutoff</span></code> but same <code class="docutils literal notranslate"><span class="pre">radius_cutoff</span></code>. On the other hand it can be quite memory-intensive for large data sets to store the neighbourhood
information alongside the data in the original format. Computing the neighbourhoods on-the-fly as we go through the data set is memory friendly but can be computationally more expensive as we fall back to brute-force neighbour-search and once computed information can not be re-used (although this is partly countered by caching). Instead of relying on the specific methods used with the <em>progressive</em> policy, the user is also encouraged to pre-compute input with any external method of choice as
needed. The possibilities of calculating neighbourhood or distance information are vast and it is wise to choose the appropriate technique for the particular data at hand.</p>
</div>
<p>Per default a clustering attempt returns and prints a comprehensive summary of the cluster parameters and the outcome. You can suppress the recording with the keyword argument <code class="docutils literal notranslate"><span class="pre">rec</span> <span class="pre">=</span> <span class="pre">False</span></code> and the printing with <code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">=</span> <span class="pre">False</span></code>:</p>
<ul class="simple">
<li><p>N: Number of data points.</p></li>
<li><p>R: Radius cutoff <em>r</em>.</p></li>
<li><p>C: CNN cutoff <em>c</em>.</p></li>
<li><p>min: Member cutoff (valid clusters need to have at least this many members).</p></li>
<li><p>max: Maximum cluster count (keep only the <em>max</em> largest clusters and disregard smaller clusters).</p></li>
<li><p>#clusters: Number of identified clusters.</p></li>
<li><p>%largest: Member share on the total number of points in the largest cluster.</p></li>
<li><p>%noise: Member share on the total number of points identified as noise (not part of any cluster).</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">min</span></code> (keyword argument <code class="docutils literal notranslate"><span class="pre">member_cutoff</span></code>) and <code class="docutils literal notranslate"><span class="pre">max</span></code> (keyword argument <code class="docutils literal notranslate"><span class="pre">max_clusters</span></code>) only take effect in an optional post processing step when <code class="docutils literal notranslate"><span class="pre">sort_by_size</span> <span class="pre">=</span> <span class="pre">True</span></code>. The clusters are sorted in order by there size (first cluster has the highest member count) and are trimmed in the way that small clusters are considered noise.</p>
<p>When we now look again at the cluster object overview, we can see that two things have changed. First, since we used the <em>progressive</em> policy above, the <code class="docutils literal notranslate"><span class="pre">Neighbourhoods</span> <span class="pre">calculated</span></code> entry now shows us, that neighbourhoods for 12 points at a search radius of <span class="math notranslate nohighlight">\(r = 1.5\)</span> are associated with our object. They can be re-used later. Second, <code class="docutils literal notranslate"><span class="pre">Clustered</span></code> is now set to <code class="docutils literal notranslate"><span class="pre">True</span></code> indicating that we have attempted to cluster the data set.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>print(cnnobj)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
================================================================================
CNN cluster object
--------------------------------------------------------------------------------
Alias :                         root
Hierachy level :                0

Data point shape :              Parts      - 1
                                Points     - 12
                                Dimensions - 2

Distance matrix calculated :    None
Neighbourhoods calculated :     12, r = 1.5
Density graph calculated :      None

Clustered :                     True
Children :                      False
================================================================================

</pre></div></div>
</div>
<p>The essential outcome of the clustering are cluster label assignments for each point. Points classified as <em>noise</em> (not part of any cluster) are labeled 0. Integer labels larger than 0 indicate the membership to one of the identified cluster of each point. If clusters where sorted (<code class="docutils literal notranslate"><span class="pre">sort_by_size</span> <span class="pre">=</span> <span class="pre">True</span></code>), cluster 1 has the highest member count.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cnnobj.labels
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Labels([1, 1, 1, 1, 1, 0, 0, 0, 0, 2, 2, 2])
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">labels</span></code> attribute of a cluster object always holds the result of the latest fit. All cluster results (from fits where <code class="docutils literal notranslate"><span class="pre">rec</span> <span class="pre">=</span> <span class="pre">True</span></code>) are collected in a summary without storing the actual labels.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>print(*cnnobj.summary, sep=&quot;\n&quot;)
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
CNNRecord(points=12, r=1.5, c=1, min=2, max=None, clusters=Labels(2), largest=0.4166666666666667, noise=0.3333333333333333, time=0.0009095668792724609)
CNNRecord(points=12, r=1.5, c=1, min=2, max=None, clusters=Labels(2), largest=0.4166666666666667, noise=0.3333333333333333, time=0.0014908313751220703)
</pre></div></div>
</div>
<p>If you have Pandas installed, the summary can be transformed into a handy <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>cnnobj.summary.to_DataFrame()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>points</th>
      <th>r</th>
      <th>c</th>
      <th>min</th>
      <th>max</th>
      <th>clusters</th>
      <th>largest</th>
      <th>noise</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>12</td>
      <td>1.5</td>
      <td>1</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>0.416667</td>
      <td>0.333333</td>
      <td>0.000910</td>
    </tr>
    <tr>
      <th>1</th>
      <td>12</td>
      <td>1.5</td>
      <td>1</td>
      <td>2</td>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>0.416667</td>
      <td>0.333333</td>
      <td>0.001491</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>A cluster object comes with a variety of convenience methods that allow for example a quick look at a plot of data points and a cluster result.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>fig, ax = plt.subplots(1, 2)
ax[0].set_title(&quot;original&quot;)
cnnobj.evaluate(ax=ax[0], original=True,
                ax_props=ax_props, plot_props=dot_props)
ax[1].set_title(&quot;clustered&quot;)
cnnobj.evaluate(ax=ax[1],
                ax_props=ax_props, plot_props=dot_props)
fig.tight_layout()
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorial_basic_usage_42_0.png" src="../_images/tutorial_basic_usage_42_0.png" />
</div>
</div>
</div>
<div class="section" id="Functional-API">
<h3>Functional API<a class="headerlink" href="#Functional-API" title="Permalink to this headline">¶</a></h3>
<p>As an alternative to the class based API, the <code class="docutils literal notranslate"><span class="pre">cnnclustering.cnn</span></code> module provides a functional API for quick results.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>labels = cnn.fit(
    data=cnn.Points(data_points),
    radius_cutoff=1.5,
    cnn_cutoff=1,
    policy=&quot;conservative&quot;
)
labels
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Execution time for call of fit: 0 hours, 0 minutes, 0.0004 seconds
--------------------------------------------------------------------------------
#points   R         C         min       max       #clusters %largest  %noise
12        1.500     1         2         None      2         0.417     0.333
--------------------------------------------------------------------------------
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Labels([1, 1, 1, 1, 1, 0, 0, 0, 0, 2, 2, 2])
</pre></div></div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">cnnclustering</a></h1>



<p class="blurb">CNN clustering and csMSM estimation in Python</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=janjoswig&repo=CNN&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../_source/install.html">Installation instructions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../_source/tutorials.html">Tutorials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basic usage of the cnn module</a></li>
<li class="toctree-l2"><a class="reference internal" href="scikit_learn_datasets.html">scikit-learn Toy data sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="hierarchical_clustering_basics.html">Hierarchical clustering basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_input_formats.html">Data input formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithm_explained.html">Density based clustering explained</a></li>
<li class="toctree-l2"><a class="reference internal" href="algorithm_explained.html#2">2</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../_source/api_reference.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../_source/tutorials.html">Tutorials</a><ul>
      <li>Previous: <a href="../_source/tutorials.html" title="previous chapter">Tutorials</a></li>
      <li>Next: <a href="scikit_learn_datasets.html" title="next chapter">scikit-learn Toy data sets</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Jan-Oliver Joswig.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/tutorial/basic_usage.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>